{
    "collab_server" : "",
    "contents" : "---\ntitle: \"Displays Ocean Solutions paper\"\nauthor: \"Jean-Pierre Gattuso\"\ndate: '`r format(Sys.Date(), \"%d %B %Y\")`'\noutput:\n  html_document:\n    code_folding: hide\n    fig_caption: yes\n    toc: yes\n    toc_float: yes\n  pdf_document:\n    toc: yes\n---\n\n```{r prep, echo=FALSE, message= FALSE}\nrm(list = ls())\nsuppressPackageStartupMessages(library(tidyverse))\nlibrary(viridis)\n#devtools::install_github(\"ricardo-bion/ggradar\", dependencies=TRUE)\n#library(ggradar)\n#library(scales)\n#download.file(\"https://dl.dropboxusercontent.com/u/2364714/airbnb_ttf_fonts/Circular Air-Light 3.46.45 PM.ttf\", \"/Library/Fonts/Circular Air-Light 3.46.45 PM.ttf\", method=\"curl\")\n#extrafont::font_import(pattern = 'Circular', prompt=FALSE)\nSys.setlocale(\"LC_ALL\", \"en_US.UTF-8\")\nSys.setenv(TZ='UTC') # on utilise UTC\ndat_sol <- read_tsv(file = \"solutions.tsv\")\ndat_sys <- read_tsv(file = \"systems.tsv\")\n```\n```{r effectiveness ocean line plots, echo=FALSE, message= FALSE, warning=FALSE}\nd <- dat_sol %>%\n  dplyr::mutate(Value = as.numeric(Value)) %>%\n  dplyr::filter(Base == \"Ocean-based\") %>%\n  dplyr::filter(Process %in% c(\"Effectiveness to moderate warming\",\n                              \"Effectiveness to moderate acidification (global)\",\n                              \"Effectiveness to moderate sea level rise\",\n                              \"Effectiveness to increase carbon uptake\"),\n                !is.na(Value)\n                )\n\neffectiveness_ocean_sol <- ggplot(data=d) +\n  geom_point(aes(x=Solution, y=Value, group=Process, color=Process, size = Confidence),\n                 position = position_dodge(width = 0.5)) +\n  geom_linerange(aes(x = Solution, ymin = 0, ymax = Value, colour = Process), \n                   position = position_dodge(width = 0.5)) +\n  coord_polar() +\n  labs(title = \"Effectiveness of ocean-based solutions\", x=\"\", y=\"\") +\n  theme(legend.position = \"right\",\n        axis.text.x = element_text(hjust=1),\n        axis.text.y = element_blank(),\n        axis.ticks = element_blank()\n        )\neffectiveness_ocean_sol\nggsave(filename = \"effectiveness_ocean_sol.png\", plot = effectiveness_ocean_sol, width = 18, height = 12, units = \"cm\")\n\n# rename processes\nd[d$Process == \"Effectiveness to moderate warming\",]$Process <- \"Moderate\\nwarming\"\nd[d$Process == \"Effectiveness to moderate acidification (global)\", ]$Process <- \"Moderate\\nacidification\"\nd[d$Process == \"Effectiveness to moderate sea level rise\", ]$Process <- \"Moderate\\nsea level rise\"\nd[d$Process == \"Effectiveness to increase carbon uptake\", ]$Process <- \"Increase\\ncarbon uptake\"\n\neffectiveness_ocean_proc <- ggplot(data=d) +\n  geom_point(aes(x=Process, y=Value, group=Solution, color=Solution, size = Confidence),\n                 position = position_dodge(width = 0.5)) +\n  geom_linerange(aes(x = Process, ymin = 0, ymax = Value, colour = Solution), \n                   position = position_dodge(width = 0.5)) +\n  #geom_polygon(data = test, aes(x = Process, y = Value)) +\n  coord_polar() +\n    labs(title = \"Effectiveness of ocean-based solutions\", x=\"\", y=\"\") +\n  theme(legend.position = \"top\",\n        axis.text.x = element_text(hjust=1),\n        axis.text.y = element_blank(),\n        axis.ticks = element_blank()\n        )\neffectiveness_ocean_proc\nggsave(filename = \"effectiveness_ocean_proc.png\", plot = effectiveness_ocean_proc)\n\n#test <- filter(dat_sol, Process == \"Controversiality\")\n  # ggplot(d) + \n  #     geom_point(aes(x=Process, y=Value, group=Solution, color=Solution, size = Confidence),\n  #                position = position_dodge(width = 0.5)) +\n  #   geom_polygon(dat_sol=filter(d, Process==\"Controversiality\"), aes(x=Process, \n  #                    y=Value, group=Solution)) +\n  #     coord_polar()\n\n```\n  \n  \n```{r effectiveness ocean bar plots, echo=FALSE, message= FALSE, warning=FALSE}\nd <- dat_sol %>%\n  dplyr::mutate(Value = as.numeric(Value)) %>%\n  dplyr::filter(Base == \"Ocean-based\") %>%\n  dplyr::filter(Process %in% c(\"Effectiveness to moderate warming\",\n                              \"Effectiveness to moderate acidification (global)\",\n                              \"Effectiveness to moderate sea level rise\",\n                              \"Effectiveness to increase carbon uptake\"),\n                !is.na(Value)\n                )\n# rename processes\nd[d$Process == \"Effectiveness to moderate warming\",]$Process <- \"Moderate\\nwarming\"\nd[d$Process == \"Effectiveness to moderate acidification (global)\", ]$Process <- \"Moderate\\nacidification\"\nd[d$Process == \"Effectiveness to moderate sea level rise\", ]$Process <- \"Moderate\\nsea level rise\"\nd[d$Process == \"Effectiveness to increase carbon uptake\", ]$Process <- \"Increase\\ncarbon uptake\"\n\n#### Effectiveness per solution bar radial\neffectiveness_ocean_sol_bar <- ggplot(data=d,\n                            aes(x=Solution, y=Value, group=Process, fill=Process)) +\n  coord_polar() +\n  geom_bar(stat = \"identity\", position = position_dodge(width = 1)) +\n  scale_fill_viridis(alpha = 0.8, discrete = TRUE, option = \"C\") +\n  labs(title = \"Effectiveness of ocean-based solutions (with confidence levels)\", x=\"\", y=\"\") +\n  geom_text(aes(y = Value + 0.3, label = Confidence), position = position_dodge(width = 1)) +\n  #facet_grid(. ~ Group) +\n  theme(legend.position = \"right\",\n        axis.text.x = element_text(hjust=1),\n        axis.text.y = element_blank(),\n        axis.ticks = element_blank()\n        )\neffectiveness_ocean_sol_bar\nggsave(filename = \"effectiveness_ocean_sol_bar.png\", plot = effectiveness_ocean_sol_bar)\n\n#### Effectiveness per process bar radial\neffectiveness_ocean_proc_bar <- ggplot(data=d,\n                            aes(x=Process, y=Value, group=Solution, fill=Solution)) +\n  coord_polar() +\n  geom_bar(stat = \"identity\", position = position_dodge(width = 1)) +\n  scale_fill_viridis(alpha = 0.8, discrete = TRUE, option = \"C\") +\n  labs(title = \"Effectiveness of ocean-based solutions (with confidence levels)\", x=\"\", y=\"\") +\n  geom_text(aes(y = Value + 0.3, label = Confidence), position = position_dodge(width = 1)) +\n  #facet_grid(. ~ Group) +\n  theme(legend.position = \"right\",\n        axis.text.x = element_text(hjust=1),\n        axis.text.y = element_blank(),\n        axis.ticks = element_blank()\n        )\neffectiveness_ocean_proc_bar\nggsave(filename = \"effectiveness_ocean_proc_bar.png\", plot = effectiveness_ocean_proc_bar)\n```\n\n```{r controversiality and technological feasibility, echo=FALSE, message= FALSE, warning=FALSE}\nd <- dat_sol %>%\n  dplyr::filter(Base == \"Ocean-based\",\n                Process %in% c(\"Controversiality\", \"Technological feasibility\"),\n                !is.na(Value))\n\n# rename processes\nd[d$Process == \"Technological feasibility\",]$Process <- \"Technological\\nfeasibility\"\n# d[d$Process == \"Effectiveness to moderate acidification (global)\", ]$Process <- \"Moderate\\nacidification\"\n# d[d$Process == \"Effectiveness to moderate sea level rise\", ]$Process <- \"Moderate\\nsea level rise\"\n# d[d$Process == \"Effectiveness to increase carbon uptake\", ]$Process <- \"Increase\\ncarbon uptake\"\n\n\n#### fig_controversiality_feasibility radial\ncontroversiality_feasibility <- ggplot(data=d,\n                            aes(x=Solution, y=Value, group=Process, fill=Process)) +\n  coord_flip() + coord_polar() +\n  geom_bar(stat = \"identity\", position = position_dodge(width = 1)) +\n  scale_fill_viridis(alpha = 0.8, discrete = TRUE, option = \"C\") +\n  labs(title = \"Controversiality and technological feasibility of ocean-based solutions\", x=\"\", y=\"\",\n       fill = \"\") +\n  theme(legend.position = \"right\",\n        axis.text.x = element_text(hjust=1),\n        axis.text.y = element_blank(),\n        axis.ticks = element_blank()\n        )\ncontroversiality_feasibility\nggsave(filename = \"controversiality_feasibility.png\", \n       plot = controversiality_feasibility)\n```\n\n```{r effectiveness non-ocean line plots, echo=FALSE, message= FALSE, warning=FALSE}\nd <- dat_sol %>%\n  dplyr::mutate(Value = as.numeric(Value)) %>%\n  dplyr::filter(Base == \"Non-ocean-based\") %>%\n  dplyr::filter(Process %in% c(\"Effectiveness to moderate warming\",\n                              \"Effectiveness to moderate acidification (global)\",\n                              \"Effectiveness to moderate sea level rise\",\n                              \"Effectiveness to increase carbon uptake\"),\n                !is.na(Value)\n                )\nd[d$Process == \"Effectiveness to moderate warming\",]$Process <- \"Moderate warming\"\nd[d$Process == \"Effectiveness to moderate acidification (global)\", ]$Process <- \"Moderate acidification\"\nd[d$Process == \"Effectiveness to moderate sea level rise\", ]$Process <- \"Moderate sea level rise\"\nd[d$Process == \"Effectiveness to increase carbon uptake\", ]$Process <- \"Increase carbon uptake\"\n\nd[d$Solution == \"Afforestation and reforestation\",]$Solution <- \"Afforestation\\nreforestation\"\nd[d$Solution == \"Direct air capture\",]$Solution <- \"Direct\\nair capture\"\nd[d$Solution == \"Enhanced weathering\",]$Solution <- \"Enhanced\\nweathering\"\nd[d$Solution == \"Other GHG\",]$Solution <- \"Other\\nGHG\"\nd[d$Solution == \"Other biological\",]$Solution <- \"Other\\nbiological\"\nd[d$Solution == \"Land albedo\",]$Solution <- \"Land\\nalbedo\"\nd[d$Solution == \"Soil storage\",]$Solution <- \"Soil\\nstorage\"\n\neffectiveness_non_ocean_sol <- ggplot(data=d) +\n  geom_point(aes(x=Solution, y=Value, group=Process, color=Process, size = Confidence),\n                 position = position_dodge(width = 0.5)) +\n  geom_linerange(aes(x = Solution, ymin = 0, ymax = Value, colour = Process), \n                   position = position_dodge(width = 0.5)) +\n  coord_polar() +\n  labs(title = \"Effectiveness of non-ocean-based solutions\", x=\"\", y=\"\") +\n  theme(legend.position = \"right\",\n        axis.text.x = element_text(hjust=1),\n        axis.text.y = element_blank(),\n        axis.ticks = element_blank()\n        )\neffectiveness_non_ocean_sol\nggsave(filename = \"effectiveness_non_ocean_sol.png\", plot = effectiveness_non_ocean_sol, width = 18, height = 12, units = \"cm\")\n\n# rename processes\nd <- dat_sol %>%\n  dplyr::mutate(Value = as.numeric(Value)) %>%\n  dplyr::filter(Base == \"Non-ocean-based\") %>%\n  dplyr::filter(Process %in% c(\"Effectiveness to moderate warming\",\n                              \"Effectiveness to moderate acidification (global)\",\n                              \"Effectiveness to moderate sea level rise\",\n                              \"Effectiveness to increase carbon uptake\"),\n                !is.na(Value)\n                )\nd[d$Process == \"Effectiveness to moderate warming\",]$Process <- \"Moderate\\nwarming\"\nd[d$Process == \"Effectiveness to moderate acidification (global)\", ]$Process <- \"Moderate\\nacidification\"\nd[d$Process == \"Effectiveness to moderate sea level rise\", ]$Process <- \"Moderate\\nsea level rise\"\nd[d$Process == \"Effectiveness to increase carbon uptake\", ]$Process <- \"Increase\\ncarbon uptake\"\nd[d$Solution == \"Afforestation and reforestation\",]$Solution <- \"Afforestation\\nreforestation\"\nd[d$Solution == \"Direct air capture\",]$Solution <- \"Direct\\nair capture\"\nd[d$Solution == \"Enhanced weathering\",]$Solution <- \"Enhanced\\nweathering\"\nd[d$Solution == \"Other GHG\",]$Solution <- \"Other\\nGHG\"\nd[d$Solution == \"Other biological\",]$Solution <- \"Other\\nbiological\"\nd[d$Solution == \"Land albedo\",]$Solution <- \"Land\\nalbedo\"\nd[d$Solution == \"Soil storage\",]$Solution <- \"Soil\\nstorage\"\n\neffectiveness_non_ocean_proc <- ggplot(data=d) +\n  geom_point(aes(x=Process, y=Value, group=Solution, color=Solution, size = Confidence),\n                 position = position_dodge(width = 0.5)) +\n  geom_linerange(aes(x = Process, ymin = 0, ymax = Value, colour = Solution), \n                   position = position_dodge(width = 0.5)) +\n  #geom_polygon(data = test, aes(x = Process, y = Value)) +\n  coord_polar() +\n    labs(title = \"Effectiveness of non-ocean-based solutions\", x=\"\", y=\"\") +\n  theme(legend.position = \"top\",\n        axis.text.x = element_text(hjust=1),\n        axis.text.y = element_blank(),\n        axis.ticks = element_blank()\n        )\neffectiveness_non_ocean_proc\nggsave(filename = \"effectiveness_non_ocean_proc.png\", plot = effectiveness_non_ocean_proc)\n```\n  \n  \n```{r effectiveness non-ocean bar plots, echo=FALSE, message= FALSE}\nd <- dat_sol %>%\n  dplyr::mutate(Value = as.numeric(Value)) %>%\n  dplyr::filter(Base == \"Non-ocean-based\") %>%\n  dplyr::filter(Process %in% c(\"Effectiveness to moderate warming\",\n                              \"Effectiveness to moderate acidification (global)\",\n                              \"Effectiveness to moderate sea level rise\",\n                              \"Effectiveness to increase carbon uptake\"),\n                !is.na(Value)\n                )\n# rename processes\nd[d$Process == \"Effectiveness to moderate warming\",]$Process <- \"Moderate warming\"\nd[d$Process == \"Effectiveness to moderate acidification (global)\", ]$Process <- \"Moderate acidification\"\nd[d$Process == \"Effectiveness to moderate sea level rise\", ]$Process <- \"Moderate sea level rise\"\nd[d$Process == \"Effectiveness to increase carbon uptake\", ]$Process <- \"Increase carbon uptake\"\nd[d$Solution == \"Afforestation and reforestation\",]$Solution <- \"Afforestation\\nreforestation\"\n\n\n#### Effectiveness non--ocean per solution bar radial\nd[d$Solution == \"Direct air capture\",]$Solution <- \"Direct\\nair capture\"\nd[d$Solution == \"Enhanced weathering\",]$Solution <- \"Enhanced\\nweathering\"\nd[d$Solution == \"Other GHG\",]$Solution <- \"Other\\nGHG\"\nd[d$Solution == \"Other biological\",]$Solution <- \"Other\\nbiological\"\nd[d$Solution == \"Land albedo\",]$Solution <- \"Land\\nalbedo\"\nd[d$Solution == \"Soil storage\",]$Solution <- \"Soil\\nstorage\"\n\neffectiveness_non_ocean_sol_bar <- ggplot(data=d,\n                            aes(x=Solution, y=Value, group=Process, fill=Process)) +\n  coord_polar() +\n  geom_bar(stat = \"identity\", position = position_dodge(width = 1)) +\n  scale_fill_viridis(alpha = 0.8, discrete = TRUE, option = \"C\") +\n  labs(title = \"Effectiveness of non-ocean-based solutions (with confidence levels)\", x=\"\", y=\"\") +\n  geom_text(aes(y = Value + 0.3, label = Confidence), position = position_dodge(width = 1)) +\n  #facet_grid(. ~ Group) +\n  theme(legend.position = \"right\",\n        axis.text.x = element_text(hjust=1),\n        axis.text.y = element_blank(),\n        axis.ticks = element_blank(),\n        plot.margin=unit(c(0, 0, 0, 0),\"cm\")\n        )\neffectiveness_non_ocean_sol_bar\nggsave(filename = \"effectiveness_non_ocean_sol_bar.png\", plot = effectiveness_non_ocean_sol_bar)\n\n#### Effectiveness per process bar radial\nd <- dat_sol %>%\n  dplyr::mutate(Value = as.numeric(Value)) %>%\n  dplyr::filter(Base == \"Non-ocean-based\") %>%\n  dplyr::filter(Process %in% c(\"Effectiveness to moderate warming\",\n                              \"Effectiveness to moderate acidification (global)\",\n                              \"Effectiveness to moderate sea level rise\",\n                              \"Effectiveness to increase carbon uptake\"),\n                !is.na(Value)\n                )\nd[d$Process == \"Effectiveness to moderate warming\",]$Process <- \"Moderate\\nwarming\"\nd[d$Process == \"Effectiveness to moderate acidification (global)\", ]$Process <- \"Moderate\\nacidification\"\nd[d$Process == \"Effectiveness to moderate sea level rise\", ]$Process <- \"Moderate\\nsea level rise\"\nd[d$Process == \"Effectiveness to increase carbon uptake\", ]$Process <- \"Increase\\ncarbon uptake\"\n\neffectiveness_non_ocean_proc_bar <- ggplot(data=d,\n                            aes(x=Process, y=Value, group=Solution, fill=Solution)) +\n  coord_polar() +\n  geom_bar(stat = \"identity\", position = position_dodge(width = 1)) +\n  scale_fill_viridis(alpha = 0.8, discrete = TRUE, option = \"C\") +\n  labs(title = \"Effectiveness of non-ocean-based solutions (with confidence levels)\", x=\"\", y=\"\") +\n  geom_text(aes(y = Value + 0.3, label = Confidence), position = position_dodge(width = 1)) +\n  theme(legend.position = \"right\",\n        axis.text.x = element_text(hjust=1),\n        axis.text.y = element_blank(),\n        axis.ticks = element_blank()\n        )\neffectiveness_non_ocean_proc_bar\nggsave(filename = \"effectiveness_non_ocean_proc_bar.png\", plot = effectiveness_non_ocean_proc_bar)\n```\n\n\n```{r systems ocean bar plots, echo=FALSE, message= FALSE, warning=FALSE}\nd <- dat_sys %>%\n  dplyr::mutate(Value = as.numeric(Value)) %>%\n  dplyr::filter(Base == \"Ocean-based\",\n                !System %in% c(\"Coral reefs\")\n  )\nfile <- c(\"seagrass\", \"polar\", \"fish_low\", \"fish_high\", \"protection\", \"bivalve\", \"mangrove\")\n       \n# rename\nd[d$Process == \"Importance of co-benefits\",]$Process <- \"Co-benefits\"\nd[d$Process == \"Importance of unintended consequences relative to benefits\",]$Process <- \"Unintended consequences\"\nd[d$Solution== \"Renewable energy\",]$Solution <- \"Renewable\\nenergy\"\nd[d$Solution == \"CO2 storage\",]$Solution <- \"CO2\\nstorage\"\nd[d$Solution == \"Other GHG removal\",]$Solution <- \"Other GHG\\nremoval\"\nd[d$Solution == \"Marine cloud brightening\",]$Solution <- \"Marine cloud\\nbrightening\"\nd[d$Solution == \"Surface ocean albedo\",]$Solution <- \"Surface ocean\\nalbedo\"\n\n#### systems per solution bar radial\nsol <- unique(d$System)\nn_sol <- length(sol)\nfor (i in 1:n_sol) {\nfile_name <- paste0(\"sys_\", file[i], \".png\")\nfig <- ggplot(data = filter(d, System==sol[i]),\n                            aes(x=Solution, y=Value, group=Process, fill=Process)) +\n  coord_polar() +\n  geom_bar(stat = \"identity\", position = position_dodge(width = 1)) +\n  scale_fill_viridis(alpha = 0.8, discrete = TRUE, option = \"C\") +\n  labs(title = sol[i], x=\"\", y=\"\") +\n  geom_text(aes(y = Value + 0.3, label = Confidence), position = position_dodge(width = 1)) +\n  theme(legend.position = \"right\",\n        axis.text.x = element_text(hjust=1),\n        axis.text.y = element_blank(),\n        axis.ticks = element_blank(),\n        plot.margin=grid::unit(c(0,0,0,0), \"mm\")\n        )\nfig\n#ggsave(filename = file_name, plot = fig, width = 15, height = 15, units = \"cm\")\nggsave(filename = file_name, plot = fig, units = \"cm\")\n}\n```",
    "created" : 1492198983683.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "656292273",
    "id" : "D50259CD",
    "lastKnownWriteTime" : 1492494425,
    "last_content_update" : 1492494425746,
    "path" : "~/Dropbox/Documents/publications/publications_inpreparation/gattuso_etal_ocean_solutions/displays/figs/figure_2017-04-17.Rmd",
    "project_path" : "figure_2017-04-17.Rmd",
    "properties" : {
    },
    "relative_order" : 1,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_markdown"
}